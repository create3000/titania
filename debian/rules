#!/usr/bin/make -f

export DH_COMPAT=4

PACKAGE=$(shell dh_listpackages)

build:
	dh_testdir

clean:
	dh_testdir
	dh_testroot
	dh_clean -d

binary-indep: build

binary-arch: build
	dh_testdir
	dh_testroot
	dh_clean -k -d

	dh_installdocs
	dh_installchangelogs

# Make and install binaries
	./autogen.sh --enable-parallel --prefix=`pwd`/debian/$(PACKAGE)/usr/
	#make distclean
	make -j4
	make install

# Copy share directorys to /usr/share
#	find . -maxdepth 2 -mindepth 2 -name share -print0 | \
#		xargs -0 -r -i cp -a {} debian/$(PACKAGE)/usr/

# Copy bin directorys to /usr/bin
#	find . -maxdepth 2 -mindepth 2 -name bin -print0 | \
#		xargs -0 -r -i cp -a {} debian/$(PACKAGE)/usr/

	dh_compress
	dh_makeshlibs
	dh_installdeb
#	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary

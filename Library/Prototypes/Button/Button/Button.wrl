#VRML V2.0 utf8

PROTO Button [
  exposedField SFBool enabled TRUE
  eventOut     SFBool isOver
  eventOut     SFBool isActive
  eventOut     SFTime touchTime
  eventIn      MFNode addChildren
  eventIn      MFNode removeChildren
  exposedField MFNode children [ ]
]
{
  Group {
    children [
      DEF Touch TouchSensor {
        enabled IS enabled
        isActive IS isActive
        isOver IS isOver
        touchTime IS touchTime
      }
      DEF Switch Switch {
        addChildren IS addChildren
        removeChildren IS removeChildren
        choice IS children
      }
    ]
  }

  DEF Button Script {
    eventIn SFBool set_enabled
    eventIn SFBool set_active
    eventIn SFBool set_over
    field   SFNode touchSensor USE Touch
    field   SFNode button USE Switch

    url "vrmlscript:
var DEFAULT  = 0;
var OVER     = 1;
var ACTIVE   = 2;
var DISABLED = 3;

function initialize ()
{
	choose ();
}

function set_enabled (value)
{
	button .whichChoice = value ? DEFAULT : DISABLED;
}

function set_active (value)
{
	choose ();
}

function set_over (value)
{
	choose ();
}

function choose ()
{
	if (touchSensor .isActive)
		button .whichChoice = touchSensor .isOver ? ACTIVE : DEFAULT;

	else if (touchSensor .isOver)
		button .whichChoice = OVER;

	else
		button .whichChoice = DEFAULT;
}
"
  }

  ROUTE Touch.enabled_changed TO Button.set_enabled
  ROUTE Touch.isActive TO Button.set_active
  ROUTE Touch.isOver TO Button.set_over
}



#VRML V2.0 utf8 Titania V3.0.3

EXTERNPROTO Torus [
  exposedField   SFFloat minorRadius
  exposedField   SFFloat majorRadius
  exposedField   SFInt32 minorDimension
  exposedField   SFInt32 majorDimension
  field          SFBool  solid
]
"Torus.json"

PROTO Grid [
  exposedField   SFInt32 xDimension 10
  exposedField   SFFloat xSpacing 1
  exposedField   SFInt32 zDimension 10
  exposedField   SFFloat zSpacing 1
  exposedField   SFColor color 1 0.5 0
  exposedField   SFFloat transparency 0.5
  field          SFBool  solid TRUE
]
{
  PROTO Fields [
    exposedField SFInt32 xDimension 10
    exposedField SFFloat xSpacing 1
    exposedField SFInt32 zDimension 10
    exposedField SFFloat zSpacing 1
    exposedField SFFloat transparency 0.66
  ]
  {
    Group { }
  }

  Transform {
    children [
      DEF Plane Transform {
        rotation 1 0 0 1.5708
        scale 10 10 1
        children Shape {
          appearance Appearance {
            material DEF Material2 Material {
              diffuseColor IS color
            }
          }
          geometry Rectangle2D {
            size 1 1
            solid IS solid
          }
        }
      }
      Transform {
        children Shape {
          appearance Appearance {
            material DEF Material3 Material {
              emissiveColor IS color
              transparency 0.594604
            }
          }
          geometry DEF Axis IndexedLineSet {
            coordIndex [
              0,
              1,
              -1,
              2,
              3,
              -1
            ]
            coord Coordinate {
              point [
                -5.25 0 0,
                5.25 0 0,
                0 0 -5.25,
                0 0 5.25
              ]
            }
          }
        }
      }
      Transform {
        children Shape {
          appearance Appearance {
            material DEF Material1 Material {
              emissiveColor IS color
            }
          }
          geometry DEF Grid IndexedLineSet {
            coordIndex [
              0,
              1,
              -1,
              2,
              3,
              -1,
              4,
              5,
              -1,
              6,
              7,
              -1,
              8,
              9,
              -1,
              10,
              11,
              -1,
              12,
              13,
              -1,
              14,
              15,
              -1,
              16,
              17,
              -1,
              18,
              19,
              -1,
              20,
              21,
              -1,
              22,
              23,
              -1,
              24,
              25,
              -1,
              26,
              27,
              -1,
              28,
              29,
              -1,
              30,
              31,
              -1,
              32,
              33,
              -1,
              34,
              35,
              -1,
              36,
              37,
              -1,
              38,
              39,
              -1,
              40,
              41,
              -1,
              42,
              43,
              -1
            ]
            coord Coordinate {
              point [
                -5 0 -5,
                -5 0 5,
                -4 0 -5,
                -4 0 5,
                -3 0 -5,
                -3 0 5,
                -2 0 -5,
                -2 0 5,
                -1 0 -5,
                -1 0 5,
                0 0 -5,
                0 0 5,
                1 0 -5,
                1 0 5,
                2 0 -5,
                2 0 5,
                3 0 -5,
                3 0 5,
                4 0 -5,
                4 0 5,
                5 0 -5,
                5 0 5,
                -5 0 -5,
                5 0 -5,
                -5 0 -4,
                5 0 -4,
                -5 0 -3,
                5 0 -3,
                -5 0 -2,
                5 0 -2,
                -5 0 -1,
                5 0 -1,
                -5 0 0,
                5 0 0,
                -5 0 1,
                5 0 1,
                -5 0 2,
                5 0 2,
                -5 0 3,
                5 0 3,
                -5 0 4,
                5 0 4,
                -5 0 5,
                5 0 5
              ]
            }
          }
        }
      }
    ]
  }

  DEF _Grid Script {
    field          SFNode plane USE Plane
    field          SFNode axis USE Axis
    field          SFNode grid USE Grid
    field          SFNode axisMaterial USE Material3
    field          SFNode fields DEF Fields Fields {
      xDimension IS xDimension
      xSpacing IS xSpacing
      zDimension IS zDimension
      zSpacing IS zSpacing
      transparency IS transparency
    }

    url "vrmlscript:
function set_dimension ()
{
}

function set_spacing ()
{
}

function initialize ()
{
	fields .transparency = fields .transparency;

	// Plane

	plane .scale = new SFVec3f (fields .xDimension * fields .xSpacing, fields .zDimension * fields .zSpacing, 1);
	
	// Axis

	axis .coord .point = new MFVec3f (new SFVec3f (-plane .scale .x / 2 - fields .xSpacing / 4, 0, 0),
	                                  new SFVec3f ( plane .scale .x / 2 + fields .xSpacing / 4, 0, 0),
	                                  new SFVec3f (0, 0, -plane .scale .y / 2 - fields .zSpacing / 4),
	                                  new SFVec3f (0, 0,  plane .scale .y / 2 + fields .zSpacing / 4));
  
	axisMaterial .transparency = Math .pow (fields .transparency, 3 / 4);

	// Grid

	var coordIndex     = new MFInt32 ();
	coordIndex .length = 3 * (fields .xDimension + fields .zDimension);
	
	var point     = grid .coord .point;
	point .length = 2 * (fields .xDimension + fields .zDimension);

	var i = 0;
	
	for (; i < fields .xDimension + 1; ++ i)
	{
		point [2 * i]          = new SFVec3f (-plane .scale .x / 2 + fields .xSpacing * i, 0, -plane .scale .y / 2);
		point [2 * i + 1]      = new SFVec3f (-plane .scale .x / 2 + fields .xSpacing * i, 0,  plane .scale .y / 2);
		coordIndex [3 * i]     = 2 * i;
		coordIndex [3 * i + 1] = 2 * i + 1;
		coordIndex [3 * i + 2] = -1;
	}
	
	for (; i < fields .zDimension + 1 + fields .xDimension + 1; ++ i)
	{
		point [2 * i]          = new SFVec3f (-plane .scale .x / 2, 0, -plane .scale .y / 2 + fields .zSpacing * (i - fields .xDimension - 1));
		point [2 * i + 1]      = new SFVec3f ( plane .scale .x / 2, 0, -plane .scale .y / 2 + fields .zSpacing * (i - fields .xDimension - 1));
		coordIndex [3 * i]     = 2 * i;
		coordIndex [3 * i + 1] = 2 * i + 1;
		coordIndex [3 * i + 2] = -1;
	}

	grid .set_coordIndex = coordIndex;
}
"
    directOutput TRUE
    mustEvaluate TRUE
  }

  ROUTE Fields.transparency_changed TO Material1.set_transparency
  ROUTE Material1.transparency_changed TO Material2.set_transparency
  ROUTE Material1.diffuseColor_changed TO Material3.set_diffuseColor
}

WorldInfo {
  metadata DEF Titania MetadataSet {
    name "Titania"
    reference "http://titania.create3000.de"
    value [
      DEF NavigationInfo MetadataSet {
        name "NavigationInfo"
        reference "http://titania.create3000.de"
        value DEF type MetadataString {
          name "type"
          reference "http://titania.create3000.de"
          value "EXAMINE"
        }
      }
      DEF Viewpoint MetadataSet {
        name "Viewpoint"
        reference "http://titania.create3000.de"
        value [
          DEF position MetadataDouble {
            name "position"
            reference "http://titania.create3000.de"
            value [
              2.42046269154235,
              4.43590572492047,
              8.62925841300815
            ]
          }
          DEF orientation MetadataDouble {
            name "orientation"
            reference "http://titania.create3000.de"
            value [
              -0.880955654761081,
              0.47244495563669,
              -0.0267001542677253,
              0.529958495538829
            ]
          }
          DEF centerOfRotation MetadataDouble {
            name "centerOfRotation"
            reference "http://titania.create3000.de"
            value [
              0,
              0,
              0
            ]
          }
        ]
      }
      DEF Selection MetadataSet {
        name "Selection"
        reference "http://titania.create3000.de"
        value DEF nodes MetadataSet {
          name "nodes"
          reference "http://titania.create3000.de"
          value DEF Torus Transform {
            translation 3.49933 0 0
            children Shape {
              appearance Appearance {
                material Material { }
              }
              geometry Torus { }
            }
          }
        }
      }
    ]
  }
  title "Grid"
}

Grid { }

DEF Sphere Transform {
  children Shape {
    appearance Appearance {
      material Material { }
    }
    geometry IndexedFaceSet {
      texCoordIndex [
        2,
        0,
        1,
        -1,
        12,
        0,
        2,
        -1,
        4,
        13,
        14,
        -1,
        5,
        0,
        15,
        -1,
        1,
        0,
        5,
        -1,
        6,
        16,
        2,
        -1,
        7,
        2,
        1,
        -1,
        17,
        1,
        5,
        -1,
        9,
        18,
        4,
        -1,
        10,
        4,
        19,
        -1,
        7,
        11,
        6,
        -1,
        20,
        11,
        7,
        -1,
        9,
        11,
        21,
        -1,
        10,
        11,
        9,
        -1,
        6,
        11,
        10,
        -1,
        2,
        7,
        6,
        -1,
        1,
        22,
        7,
        -1,
        5,
        23,
        24,
        -1,
        4,
        10,
        9,
        -1,
        25,
        6,
        10,
        -1
      ]
      coordIndex [
        2,
        0,
        1,
        -1,
        3,
        0,
        2,
        -1,
        4,
        0,
        3,
        -1,
        5,
        0,
        4,
        -1,
        1,
        0,
        5,
        -1,
        6,
        3,
        2,
        -1,
        7,
        2,
        1,
        -1,
        8,
        1,
        5,
        -1,
        9,
        5,
        4,
        -1,
        10,
        4,
        3,
        -1,
        7,
        11,
        6,
        -1,
        8,
        11,
        7,
        -1,
        9,
        11,
        8,
        -1,
        10,
        11,
        9,
        -1,
        6,
        11,
        10,
        -1,
        2,
        7,
        6,
        -1,
        1,
        8,
        7,
        -1,
        5,
        9,
        8,
        -1,
        4,
        10,
        9,
        -1,
        3,
        6,
        10,
        -1
      ]
      texCoord TextureCoordinate {
        point [
          0.2 0.647584,
          0.3 0.352416,
          0.4 0.647584,
          0.5 1,
          1 0.647584,
          0.1 0.352416,
          0.6 0.647584,
          0.5 0.352416,
          1 0,
          0.9 0.352416,
          0.8 0.647584,
          0.7 0.352416,
          0.3 1,
          1.2 0.647584,
          1.1 1,
          0 0.647584,
          0.5 1,
          0.2 0,
          1.1 0.352416,
          0.9 1,
          0.6 0,
          0.8 0,
          0.4 0,
          -0.1 0.352416,
          -2.77556e-17 0,
          0.7 1
        ]
      }
      coord Coordinate {
        point [
          -0.850651 0.447214 -0.276393,
          -0.850651 -0.447214 0.276393,
          -0.525731 0.447214 0.723607,
          0 1 2.77556e-17,
          2.94903e-16 0.447214 -0.894427,
          -0.525731 -0.447214 -0.723607,
          0.525731 0.447214 0.723607,
          -2.94903e-16 -0.447214 0.894427,
          0 -1 -2.77556e-17,
          0.525731 -0.447214 -0.723607,
          0.850651 0.447214 -0.276393,
          0.850651 -0.447214 0.276393
        ]
      }
    }
  }
}

USE Torus

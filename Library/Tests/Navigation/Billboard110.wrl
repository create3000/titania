#VRML V2.0 utf8

META "title" "Billboard 1 1 0"

Background {
  skyAngle [ 0.8, 1.3, 1.4, 1.5708 ]
  skyColor [ 0.21 0.31 0.59, 0.33 0.45 0.7, 0.57 0.66 0.85, 0.6 0.73 0.89, 0.7 0.83 0.98 ]
  groundAngle [ 0.6, 1.2, 1.3, 1.5708 ]
  groundColor [ 0.21 0.31 0.59, 0.33 0.45 0.7, 0.57 0.66 0.85, 0.6 0.73 0.89, 0.7 0.83 0.98 ]
}

Viewpoint {
  description "Front"
}

Viewpoint {
  description "z pi/2"
  orientation 0 0 1 1.5708
}

Viewpoint {
  description "y pi/2"
  position 10 0 0
  orientation 0 1 0 1.5708
}

DEF Billboard Billboard {
  axisOfRotation 1 1 0
  children [
    Transform {
      rotation 1 0 0 1.5708
      children Shape {
        appearance Appearance {
          material Material { }
        }
        geometry Cone { }
      }
    }
    Shape {
      appearance Appearance {
        material Material { }
      }
      geometry IndexedLineSet {
        coordIndex [ 0, 1, -1 ]
        coord DEF Local Coordinate {
          point [ 0 0 0, -1 1 0 ]
        }
      }
    }
  ]
}

Shape {
  appearance Appearance {
    material Material { }
  }
  geometry IndexedLineSet {
    coordIndex [ 0, 1, -1 ]
    coord DEF Absolute Coordinate {
      point [ -1 -1 0, 1 1 0 ]
    }
  }
}

DEF Touch TouchSensor { }

DEF AxisScript Script {
  eventIn SFTime set_time
  field   SFNode billboard USE Billboard
  field   SFNode absolute USE Absolute
  field   SFNode local USE Local

  url "vrmlscript:
function set_time ()
{
	var axisOfRotation = new SFVec3f (Math .random (), Math .random (), Math .random ()) .normalize ();

	billboard .axisOfRotation = axisOfRotation;

	local .point [1] = new SFRotation (0, 0, 1, Math .PI / 2) .multVec (axisOfRotation);

	absolute .point [0] = axisOfRotation .negate ();
	absolute .point [1] = axisOfRotation;

	print ('axisOfRotation: ' + axisOfRotation);
}
"
}

ROUTE Touch.touchTime TO AxisScript.set_time

#VRML V2.0 utf8 Titania

META "title" "Scripting test"

EXTERNPROTO Particle [
  exposedField SFBool     enabled
  exposedField SFDouble   maximumSpeed
  exposedField SFDouble   mass
  exposedField SFVec3f    acceleration
  exposedField SFVec3f    velocity
  exposedField SFVec3f    translation
  exposedField SFRotation rotation
  exposedField SFTime     startTime
  exposedField SFTime     stopTime
  eventOut     SFBool     isActive
  exposedField MFNode     friends
  eventIn      MFNode     addChildren
  eventIn      MFNode     removeChildren
  exposedField MFNode     children
]
"/home/holger/Arbeitsfl√§che/Particle/Particle.wrl"

PROTO Test [
  exposedField MFNode children [ ]
]
{
  DEF Group Group {
    children IS children
  }

  DEF ParticleGroup Script {
    eventIn MFNode set_children
    field   SFNode group USE Group
    field   SFNode self USE ParticleGroup

    url "vrmlscript:
function initialize ()
{
	print ('initialize');

	Browser .addRoute (group, 'children', self, 'set_children');

	group .children = group .children;
}

function set_children (value, time)
{
	print ('children: ', time, ' ', value .length);
		
	for (var particle in value)
	{
		for (var friend in value)
		{
			if (friend != particle)
				value [particle] .friends [value [particle] .friends .length] = value [friend];
		}
	}
}
    "
    directOutput TRUE
  }
}

Test { children [ Particle { enabled FALSE } ] }
